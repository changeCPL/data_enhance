# 反诈数据增强工具架构说明

## 系统架构概览

```
┌─────────────────────────────────────────────────────────────────┐
│                    反诈数据增强工具（深度学习集成版）                    │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                        主控制器 (main.py)                        │
│                    FraudDetectionAnalyzer                       │
│                    - 集成传统NLP和深度学习模块                      │
│                    - 支持可选的深度学习功能                        │
│                    - 提供完整的分析流程                          │
└─────────────────────────────────────────────────────────────────┘
                                │
                ┌───────────────┼───────────────┐
                ▼               ▼               ▼
┌─────────────────────┐ ┌─────────────────────┐ ┌─────────────────────┐
│   数据预处理模块      │ │   分析处理模块        │ │   数据增强模块        │
│                     │ │                     │ │                     │
│ • DataPreprocessor  │ │ • KeywordExtractor  │ │ • DataAugmentation  │
│   (文本清理)        │ │   (TF-IDF + BERT)   │ │   (智能生成)        │
│                     │ │ • PatternAnalyzer   │ │ • DLTextGenerator   │
│                     │ │   (模式+结构化信息)  │ │ • PromptEngine      │
│                     │ │ • SemanticAnalyzer  │ │                     │
│                     │ │   (语义分析)        │ │                     │
└─────────────────────┘ └─────────────────────┘ └─────────────────────┘
```

## 模块详细说明

### 1. 数据预处理层（重构版）
```
DataPreprocessor
├── 文本清理和标准化
│   ├── Unicode标准化 (NFKC)
│   ├── OCR噪音字符清理
│   └── 多余空格处理
├── 基础数据统计
│   ├── 文本长度统计
│   ├── 标签分布统计
│   └── 数据质量验证
└── JSONL格式输出
    └── 每行一个JSON对象

注意：结构化信息提取功能已移至PatternAnalyzer模块
```

### 2. 分析处理层（重构版）
```
KeywordExtractor (重构优化版)
├── TF-IDF关键词提取
│   ├── 支持动态top_k参数
│   ├── 停用词过滤
│   └── n-gram特征提取
├── 委托语义关键词提取
│   ├── 委托给SemanticAnalyzer模块
│   ├── 语义重要性计算
│   └── 上下文关键词分析
├── 标签特定关键词识别
│   ├── 网站名提取
│   ├── 动词提取
│   └── 频次统计
├── 性能优化
│   ├── 动态候选词限制
│   ├── 批量处理优化
│   └── 向后兼容性支持
└── 语义分析器集成
    ├── 语义分析器引用
    ├── 自动回退机制
    └── 错误处理

PatternAnalyzer (集成版)
├── 话术模式匹配
│   ├── 标签特定模式模板
│   ├── 通用模式模板
│   └── 正则表达式匹配
├── 结构化信息提取
│   ├── 电话号码提取（支持国际格式）
│   ├── 联系方式提取（多平台支持）
│   ├── 加密货币地址提取
│   ├── 银行信息提取
│   └── 可疑模式分类提取
└── DataFrame集成
    ├── 自动添加结构化信息列
    ├── 布尔特征标记
    └── 数据完整性保证
```

### 3. 语义分析层（独立模块）
```
SemanticAnalyzer
├── 多模型支持
│   ├── SentenceTransformers
│   ├── HuggingFace Transformers
│   └── 自动回退机制
├── 语义相似度计算
│   ├── 余弦相似度计算
│   ├── 相似文本查找
│   └── 阈值过滤
├── 文本聚类分析
│   ├── K-means聚类
│   ├── DBSCAN聚类
│   └── 聚类结果分析
├── 异常检测
│   ├── 语义异常识别
│   ├── 低相似度文本检测
│   └── 异常统计报告
├── 可视化功能
│   ├── PCA降维
│   ├── 语义空间可视化
│   └── 标签分布展示
├── 高级关键词提取
│   ├── 语义关键词提取
│   │   ├── 多维度评分系统
│   │   ├── 语义重要性(60%) + 词频(30%) + 位置权重(10%)
│   │   └── 智能缓存机制
│   ├── 上下文关键词提取
│   │   ├── 图论方法
│   │   ├── 聚类预筛选
│   │   └── 自适应阈值
│   └── 综合关键词提取
│       ├── 加权合并算法
│       └── 多维度分析
└── 性能优化
    ├── 批量编码
    ├── 结果缓存
    ├── 特征缓存
    └── 内存优化
```

### 4. 智能生成层（混合策略）
```
DLTextGenerator
├── 多模型支持
│   ├── GPT-2中文模型
│   ├── 自动回退机制
│   └── 模型配置管理
├── 文本生成策略
│   ├── 参数化生成配置
│   ├── 文本后处理
│   └── 质量验证
├── 生成质量评估
│   ├── 语义相似度评估
│   ├── 多样性计算
│   └── 质量指标统计
└── 备用生成方案
    ├── 基于规则的模板生成
    ├── 同义词替换
    └── 数字变化

PromptEngine
├── 智能Prompt生成
│   ├── 基于标签的模板
│   ├── 语义驱动创建
│   └── 多维度优化
├── 元素配置
│   ├── 标签特定元素
│   ├── 需求配置
│   └── 特征配置
└── 动态Prompt创建
    ├── 随机元素组合
    ├── 上下文感知
    └── 质量保证

DataAugmentation (混合增强版)
├── 混合生成策略
│   ├── 深度学习生成 (60%)
│   ├── 模板生成 (40%)
│   └── 规则增强 (补充)
├── 智能Prompt集成
│   ├── 语义驱动Prompt
│   ├── 关键词引导生成
│   └── 模式引导生成
├── 质量保证机制
│   ├── 文本有效性验证
│   ├── 标签一致性检查
│   └── 长度和内容过滤
└── 结构化信息提取
    ├── 自动实体提取
    ├── 布尔特征标记
    └── 数据完整性保证
```

## 数据流图

```
输入数据 (JSONL)
        │
        ▼
┌─────────────────┐
│ DataPreprocessor│ ← 文本清理和标准化
└─────────────────┘
        │
        ▼
┌─────────────────┐    ┌─────────────────┐
│ KeywordExtractor│    │ PatternAnalyzer │
│ (TF-IDF + 委托) │    │ (模式+结构化信息) │
└─────────────────┘    └─────────────────┘
        │                       │
        └───────────┬───────────┘
                    ▼
        ┌─────────────────┐
        │ SemanticAnalyzer│ ← 统一语义分析服务
        │ (语义分析+高级关键词提取) │
        └─────────────────┘
                    │
                    ▼
        ┌─────────────────┐
        │ DataAugmentation│ ← 混合生成策略
        │ (智能+模板)     │
        └─────────────────┘
                    │
                    ▼
        输出结果 (JSONL + 报告)
```

## 技术栈

### 传统NLP技术
- **jieba**: 中文分词
- **scikit-learn**: TF-IDF、聚类、评估
- **pandas**: 数据处理
- **numpy**: 数值计算
- **regex**: 正则表达式

### 深度学习技术
- **transformers**: Hugging Face预训练模型
- **torch**: PyTorch深度学习框架
- **sentence-transformers**: 语义嵌入
- **BERT**: 中文预训练模型（用于语义分析）
- **GPT**: 文本生成模型

### 可视化和工具
- **matplotlib/seaborn**: 数据可视化
- **plotly**: 交互式图表
- **tqdm**: 进度条
- **argparse**: 命令行参数

## 性能优化

### 1. 模型优化
- 支持GPU加速
- 批量处理
- 模型缓存
- 内存优化

### 2. 数据处理优化
- 批量处理优化
- 动态参数配置
- 内存使用优化
- 错误恢复机制
- **性能自适应**：根据数据量动态调整处理参数
- **模块化设计**：各模块独立，便于维护和扩展

### 3. 用户体验优化
- 进度显示
- 错误处理
- 配置灵活
- 结果可视化

## 扩展性设计

### 1. 模块化架构
- 每个模块独立
- 接口标准化
- 易于替换和扩展

### 2. 配置驱动
- 模型参数可配置
- 处理流程可定制
- 支持多种模式

### 3. 插件化支持
- 新模型易于集成
- 新功能易于添加
- 第三方工具支持

## 部署架构

### 开发环境
```
本地开发
├── Python 3.8+
├── Jupyter Notebook
├── 本地GPU (可选)
└── 开发工具
```

### 生产环境
```
服务器部署
├── Docker容器
├── GPU集群
├── 负载均衡
└── 监控系统
```

### 云端部署
```
云服务
├── AWS/Azure/GCP
├── 容器服务
├── 模型服务
└── 数据存储
```

## 安全考虑

### 1. 数据安全
- 本地处理优先
- 数据加密
- 访问控制
- 审计日志

### 2. 模型安全
- 模型验证
- 输入检查
- 输出过滤
- 异常处理

### 3. 隐私保护
- 数据脱敏
- 匿名化处理
- 合规检查
- 用户同意

## 监控和维护

### 1. 性能监控
- 处理时间
- 内存使用
- GPU利用率
- 错误率

### 2. 质量监控
- 模型准确率
- 生成质量
- 用户反馈
- 数据质量

### 3. 维护策略
- 定期更新
- 模型重训练
- 性能优化
- 安全补丁

## 未来发展方向

### 1. 技术升级
- 更先进的预训练模型
- 多模态分析
- 联邦学习
- 边缘计算

### 2. 功能扩展
- 实时检测
- 多语言支持
- 自动化标注
- 智能推荐

### 3. 应用拓展
- 行业定制
- 平台集成
- API服务
- 移动应用
